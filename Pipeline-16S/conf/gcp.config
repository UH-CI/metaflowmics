/*
 * -------------------------------------------------
 *  University of Hawaii at Manoa cluster config file
 * -------------------------------------------------
 * 
 */

params {
   referenceAln = "${PWD}/databases/silva.nr_v132.align"
   referenceTax = "${PWD}/databases/silva.full_v132.tax"
}

env{
    PYTHONPATH="/workspace/:${PYTHONPATH}"
}

executor{
    jobName = { "$task.tag" }
    queueSize = 4
}

docker.enabled = true

cloud {
      driver = 'google'
      imageId = 'ubuntu-os-cloud/global/images/ubuntu-1804-bionic-v20190722a'
      instanceType = 'n1-standard-1'
}

google {
       project = 'c-maiki-pipelines'
       zone = 'us-west2-a'
}

process {
    executor = 'google-pipelines'

    stageInMode = 'symlink'
    stageOutMode = 'rsync'
    container = 'nextflow/nextflow'

    withLabel: low_computation {
	  cpus = 1
	  memory = 3.GB
	  time = '1h'
    }
    withLabel: medium_computation {
	  cpus = 2
	  memory = 7.GB
	  time = '3h'
    }
    withLabel: high_computation {
	  cpus = 4
	  memory = 15.GB
	  time = '1d'
    }
}	

process {
   withLabel: fastx_tk {
   	     container = 'alexcoppe/fastx'
   }
   withLabel: mothur_script {
   	      container = 'nakor/mothur_pipeline'
   }
   withLabel: r_script {
   	      container = 'nakor/r_libs_pipeline'
   }
   withLabel: python_script {
   	      container = 'nakor/python_libs_pipeline'
   }
   withLabel: vsearch {
   	      container = 'nakor/python_libs_pipeline'
   }
}

